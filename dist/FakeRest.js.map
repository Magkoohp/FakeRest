{"version":3,"sources":["webpack://FakeRest/webpack/universalModuleDefinition","webpack://FakeRest/./src/Collection.js","webpack://FakeRest/./src/FakeRest.js","webpack://FakeRest/./src/FetchServer.js","webpack://FakeRest/./src/Server.js","webpack://FakeRest/./src/Single.js","webpack://FakeRest/./src/parseQueryString.js","webpack://FakeRest/webpack/bootstrap","webpack://FakeRest/webpack/runtime/define property getters","webpack://FakeRest/webpack/runtime/hasOwnProperty shorthand","webpack://FakeRest/webpack/runtime/make namespace object","webpack://FakeRest/webpack/startup"],"names":["every","array","predicate","reduce","acc","value","some","filterItems","items","filter","Object","filterFunctions","keys","map","key","regex","RegExp","q","item","itemKey","match","indexOf","realKey","replace","Array","isArray","v","itemValue","length","selected","filterFunction","Error","sortItems","sort","a","b","direction","toLowerCase","rangeItems","range","slice","undefined","Collection","identifierName","sequence","server","name","addOne","bind","resourceName","singularResourceName","referenceName","otherCollection","collections","getAll","i","pluralResourceName","getOne","e","embed","resourceNames","resourceEmbedders","endsWith","_oneToManyEmbedder","_manyToOneEmbedder","itemWithEmbeds","embedder","query","assign","_itemEmbedder","identifier","findIndex","index","getIndex","Math","max","push","splice","Server","FetchServer","Single","request","opts","req","Request","queryString","decodeURIComponent","url","params","parseQueryString","text","then","requestBody","requestJson","JSON","parse","requestInterceptors","previous","current","response","responseInterceptors","log","headers","Headers","loggingEnabled","console","group","groupCollapsed","method","groupEnd","status","body","decode","batchUrl","batch","getSingleNames","matches","baseUrl","getOnly","error","reponse","respond","updateOnly","getCollectionNames","defaultQuery","count","getCount","first","last","min","newResource","newResourceURI","getCollection","id","updateOne","removeOne","singles","data","addCollection","addSingle","warn","collection","setServer","setName","single","interceptor","hasOwnProperty","json","stringify","requestHeaders","handle","jsonResponse","requestName","subResponse","sub","code","headerName","contentRange","Location","obj","queryObject","queryElements","split","queryElement","trim"],"mappings":"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","file":"FakeRest.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"FakeRest\"] = factory();\n\telse\n\t\troot[\"FakeRest\"] = factory();\n})(self, function() {\nreturn ","const every = (array, predicate) =>\n    array.reduce((acc, value) => acc && predicate(value), true);\n\nconst some = (array, predicate) =>\n    array.reduce((acc, value) => acc || predicate(value), false);\n\nfunction filterItems(items, filter) {\n    if (typeof filter === 'function') {\n        return items.filter(filter);\n    }\n    if (filter instanceof Object) {\n        // turn filter properties to functions\n        var filterFunctions = Object.keys(filter).map(key => {\n            if (key === 'q') {\n                let regex = new RegExp(filter.q, 'i');\n                // full-text filter\n                return item => {\n                    for (let itemKey in item) {\n                        if (item[itemKey] && item[itemKey].match && item[itemKey].match(regex) !== null) return true;\n                    }\n                    return false;\n                };\n            }\n            let value = filter[key];\n            if (key.indexOf('_lte') !== -1) {\n                // less than or equal\n                let realKey = key.replace(/(_lte)$/, '');\n                return item => item[realKey] <= value;\n            }\n            if (key.indexOf('_gte') !== -1) {\n                // less than or equal\n                let realKey = key.replace(/(_gte)$/, '');\n                return item => item[realKey] >= value;\n            }\n            if (key.indexOf('_lt') !== -1) {\n                // less than or equal\n                let realKey = key.replace(/(_lt)$/, '');\n                return item => item[realKey] < value;\n            }\n            if (key.indexOf('_gt') !== -1) {\n                // less than or equal\n                let realKey = key.replace(/(_gt)$/, '');\n                return item => item[realKey] > value;\n            }\n            if (Array.isArray(value)) {\n                return item => {\n                    if (Array.isArray(item[key])) {\n                        // array filter and array item value: where all items in values\n                        return every(\n                            value,\n                            v => some(item[key], itemValue => itemValue == v)\n                        );\n                    }\n                    // where item in values\n                    return value.filter(v => v == item[key]).length > 0;\n                }\n            }\n            return item => {\n                if (Array.isArray(item[key]) && typeof value == 'string') {\n                    // simple filter but array item value: where value in item\n                    return item[key].indexOf(value) !== -1;\n                }\n                if (typeof item[key] == 'boolean' && typeof value == 'string') {\n                    // simple filter but boolean item value: boolean where\n                    return item[key] == (value === 'true' ? true : false);\n                }\n                // simple filter\n                return item[key] == value;\n            };\n        });\n        // only the items matching all filters functions are in (AND logic)\n        return items.filter(item =>\n            filterFunctions.reduce((selected, filterFunction) => selected && filterFunction(item), true)\n        );\n    }\n    throw new Error('Unsupported filter type');\n}\n\nfunction sortItems(items, sort) {\n    if (typeof sort === 'function') {\n        return items.sort(sort);\n    }\n    if (typeof sort === 'string') {\n        return items.sort(function(a, b) {\n          if (a[sort] > b[sort]) {\n            return 1;\n          }\n          if (a[sort] < b[sort]) {\n            return -1;\n          }\n          return 0;\n        });\n    }\n    if (Array.isArray(sort)) {\n        let key = sort[0];\n        let direction = sort[1].toLowerCase() == 'asc' ? 1 : -1;\n        return items.sort(function(a, b) {\n          if (a[key] > b[key]) {\n            return direction;\n          }\n          if (a[key] < b[key]) {\n            return -1 * direction ;\n          }\n          return 0;\n        });\n    }\n    throw new Error('Unsupported sort type');\n}\n\nfunction rangeItems(items, range) {\n    if (Array.isArray(range)) {\n        return items.slice(range[0], range[1] !== undefined ? range[1] + 1 : undefined);\n    }\n    throw new Error('Unsupported range type');\n}\n\nexport class Collection {\n\n    constructor(items=[], identifierName='id') {\n        if (!Array.isArray(items)) {\n            throw new Error('Can\\'t initialize a Collection with anything else than an array of items');\n        }\n        this.sequence = 0; // id of the next item\n        this.identifierName = identifierName;\n        this.items = [];\n        this.server = null;\n        this.name = null;\n        items.map(this.addOne.bind(this));\n    }\n\n    /**\n     * A Collection may need to access other collections (e.g. for embedding references)\n     * This is done through a reference to the parent server.\n     */\n    setServer(server) {\n        this.server = server;\n    }\n\n    setName(name) {\n        this.name = name;\n    }\n\n    /**\n     * Get a one to many embedder function for a given resource name\n     *\n     * @example embed posts for an author\n     *\n     *     authorsCollection._oneToManyEmbedder('posts')\n     *\n     * @returns Function item => item\n     */\n    _oneToManyEmbedder(resourceName) {\n        const singularResourceName = this.name.slice(0,-1);\n        const referenceName = singularResourceName + '_id';\n        return (item) => {\n            const otherCollection = this.server.collections[resourceName];\n            if (!otherCollection) throw new Error(`Can't embed a non-existing collection ${resourceName}`);\n            if (Array.isArray(item[resourceName])) {\n                // the many to one relationship is carried by an array of ids, e.g. { posts: [1, 2] } in authors\n                item[resourceName] = otherCollection.getAll({\n                    filter: i => item[resourceName].indexOf(i[otherCollection.identifierName]) !== -1\n                });\n            } else {\n                // the many to one relationship is carried by references in the related collection, e.g. { author_id: 1 } in posts\n                item[resourceName] = otherCollection.getAll({\n                    filter: i => i[referenceName] == item[this.identifierName]\n                });\n            }\n            return item;\n        };\n    }\n\n    /**\n     * Get a many to one embedder function for a given resource name\n     *\n     * @example embed author for a post\n     *\n     *     postsCollection._manyToOneEmbedder('author')\n     *\n     * @returns Function item => item\n     */\n    _manyToOneEmbedder(resourceName) {\n        const pluralResourceName = resourceName + 's';\n        const referenceName = resourceName + '_id';\n        return (item) => {\n            const otherCollection = this.server.collections[pluralResourceName];\n            if (!otherCollection) throw new Error(`Can't embed a non-existing collection ${resourceName}`);\n            try {\n                item[resourceName] = otherCollection.getOne(item[referenceName]);\n            } catch (e) {\n                // resource doesn't exist in the related collection - do not embed\n            }\n            return item;\n        };\n    }\n\n    /**\n     * @param String[] An array of resource names, e.g. ['books', 'country']\n     * @returns Function item => item\n     */\n    _itemEmbedder(embed) {\n        const resourceNames = Array.isArray(embed) ? embed : [embed];\n        const resourceEmbedders = resourceNames.map(resourceName =>\n            resourceName.endsWith('s') ? this._oneToManyEmbedder(resourceName) : this._manyToOneEmbedder(resourceName)\n        );\n        return item => resourceEmbedders.reduce((itemWithEmbeds, embedder) => embedder(itemWithEmbeds), item);\n    }\n\n    getCount(query) {\n        return this.getAll(query).length;\n    }\n\n    getAll(query) {\n        var items = this.items.slice(0); // clone the array to avoid updating the core one\n        if (query) {\n            if (query.filter) {\n                items = filterItems(items, query.filter);\n            }\n            if (query.sort) {\n                items = sortItems(items, query.sort);\n            }\n            if (query.range) {\n                items = rangeItems(items, query.range);\n            }\n            items = items.map(item => Object.assign({}, item)) // clone item to avoid returning the original\n            if (query.embed && this.server) {\n                items = items.map(this._itemEmbedder(query.embed)); // embed reference\n            }\n        }\n        return items;\n    }\n\n    getIndex(identifier) {\n        return this.items.findIndex(item => item[this.identifierName] == identifier);\n    }\n\n    getOne(identifier, query) {\n        let index = this.getIndex(identifier);\n        if (index === -1) {\n            throw new Error(`No item with identifier ${ identifier }`);\n        }\n        let item = this.items[index];\n        item = Object.assign({}, item); // clone item to avoid returning the original\n        if (query && query.embed && this.server) {\n            item = this._itemEmbedder(query.embed)(item); // embed reference\n        }\n        return item;\n    }\n\n    addOne(item) {\n        var identifier = item[this.identifierName];\n        if (identifier !== undefined) {\n            if (this.getIndex(identifier) !== -1) {\n                throw new Error(`An item with the identifier ${ identifier } already exists`);\n            } else {\n                this.sequence = Math.max(this.sequence, identifier) + 1;\n            }\n        } else {\n            item[this.identifierName] = this.sequence++;\n        }\n        this.items.push(item);\n        return Object.assign({}, item); // clone item to avoid returning the original;\n    }\n\n    updateOne(identifier, item) {\n        let index = this.getIndex(identifier);\n        if (index === -1) {\n            throw new Error(`No item with identifier ${ identifier }`);\n        }\n        for (let key in item) {\n            this.items[index][key] = item[key];\n        }\n        return Object.assign({}, this.items[index]); // clone item to avoid returning the original\n    }\n\n    removeOne(identifier) {\n        let index = this.getIndex(identifier);\n        if (index === -1) {\n            throw new Error(`No item with identifier ${ identifier }`);\n        }\n        var item = this.items[index];\n        this.items.splice(index, 1);\n        if (identifier == (this.sequence - 1)) {\n            this.sequence--;\n        }\n        return item;\n    }\n}\n","import { Server } from './Server';\nimport { FetchServer } from './FetchServer';\nimport { Collection } from './Collection';\nimport { Single } from './Single';\n\nexport { Server, FetchServer, Collection, Single };\nexport default { Server, FetchServer, Collection, Single };\n","import { Server } from './Server';\nimport { parseQueryString } from './parseQueryString';\n\nexport class FetchServer extends Server {\n    decode(request, opts) {\n        const req = (typeof request === 'string') ? new Request(request, opts) : request;\n        req.queryString = decodeURIComponent(req.url.slice(req.url.indexOf('?') + 1));\n        req.params = parseQueryString(req.queryString);\n        return req.text()\n            .then(text => {\n                req.requestBody = text\n                try {\n                    req.requestJson = JSON.parse(text)\n                } catch(e) {\n                    // not JSON, no big deal\n                }\n            })\n            .then(() => this.requestInterceptors.reduce((previous, current) => current(previous), req))\n    }\n\n    respond(response, request) {\n        response = this.responseInterceptors.reduce(function(previous, current) {\n            return current(previous, request);\n        }, response);\n        this.log(request, response);\n        response.headers = new Headers(response.headers)\n\n        return response;\n    }\n\n    log(request, response) {\n        if (!this.loggingEnabled) return;\n        if (console.group) {\n            // Better logging in Chrome\n            console.groupCollapsed(request.method, request.url, '(FakeRest)');\n            console.group('request');\n            console.log(request.method, request.url);\n            console.log('headers', request.headers);\n            console.log('body   ', request.requestBody);\n            console.groupEnd();\n            console.group('response', response.status);\n            console.log('headers', response.headers);\n            console.log('body   ', response.body);\n            console.groupEnd();\n            console.groupEnd();\n        } else {\n            console.log('FakeRest request ', request.method, request.url, 'headers', request.headers, 'body', request.requestBody);\n            console.log('FakeRest response', response.status, 'headers', response.headers, 'body', response.body);\n        }\n    }\n\n    batch(request) {\n        throw new Error('not implemented');\n    }\n\n    /**\n     * @param {Request} fetch request\n     * @param {Object} options\n     *\n     */\n    handle(req, opts) {\n        return this.decode(req, opts)\n            .then(request => {\n                const response = {\n                    headers: {'Content-Type': 'application/json' },\n                    status: 200,\n                };\n\n                // handle batch request\n                if (this.batchUrl && this.batchUrl === request.url && request.method === 'POST') {\n                    return this.batch(request);\n                }\n\n                // Handle Single Objects\n                for (let name of this.getSingleNames()) {\n                    let matches = request.url.match(new RegExp('^' + this.baseUrl + '\\\\/(' + name + ')(\\\\/?.*)?$' ));\n                    if (!matches) continue;\n\n                    if (request.method == 'GET') {\n                        try {\n                            response.body = this.getOnly(name);\n                        } catch (error) {\n                            reponse.status = 404;\n                        }\n                        return this.respond(response, request);\n                    }\n                    if (request.method == 'PUT') {\n                        try {\n                            response.body = this.updateOnly(name, request.requestJson);\n                        } catch (error) {\n                            reponse.status = 404;\n                        }\n                        return this.respond(response, request);\n                    }\n                    if (request.method == 'PATCH') {\n                       try {\n                            response.body = this.updateOnly(name, request.requestJson);\n                        } catch (error) {\n                            reponse.status = 404;\n                        }\n                        return this.respond(response, request);\n                    }\n                }\n\n                // handle collections\n                for (let name of this.getCollectionNames()) {\n                    let matches = request.url.match(new RegExp('^' + this.baseUrl + '\\\\/(' + name + ')(\\\\/(\\\\d+))?(\\\\?.*)?$' ));\n                    if (!matches) continue;\n                    let params = Object.assign({}, this.defaultQuery(name), request.params);\n                    if (!matches[2]) {\n                        if (request.method == 'GET') {\n                            let count = this.getCount(name, params.filter ? { filter: params.filter } : {});\n                            if (count > 0) {\n                                let items = this.getAll(name, params);\n                                let first = params.range ? params.range[0] : 0;\n                                let last = params.range ? Math.min(items.length - 1 + first, params.range[1]) : (items.length - 1);\n                                response.body = items;\n                                response.headers['Content-Range'] = `items ${first}-${last}/${count}`;\n                                response.status = (items.length == count) ? 200 : 206;\n                            } else {\n                                response.body = [];\n                                response.headers['Content-Range'] = 'items */0';\n                            }\n                            return this.respond(response, request);\n                        }\n                        if (request.method == 'POST') {\n                            let newResource = this.addOne(name, request.requestJson);\n                            let newResourceURI = this.baseUrl + '/' + name + '/' + newResource[this.getCollection(name).identifierName];\n                            response.body = newResource;\n                            response.headers['Location'] = newResourceURI;\n                            response.status = 201;\n                            return this.respond(response, request);\n                        }\n                    } else {\n                        let id = matches[3];\n                        if (request.method == 'GET') {\n                            try {\n                                response.body = this.getOne(name, id, params);\n                            } catch (error) {\n                                response.status = 404;\n                            }\n                            return this.respond(response, request);\n                        }\n                        if (request.method == 'PUT') {\n                            try {\n                                response.body = this.updateOne(name, id, request.requestJson);\n                            } catch (error) {\n                                response.status = 404;\n                            }\n                            return this.respond(response, request);\n                        }\n                        if (request.method == 'PATCH') {\n                            try {\n                                response.body = this.updateOne(name, id, request.requestJson);\n                            } catch (error) {\n                                response.status = 404;\n                            }\n                            return this.respond(response, request);\n                        }\n                        if (request.method == 'DELETE') {\n                            try {\n                                response.body = this.removeOne(name, id);\n                            } catch (error) {\n                                response.status = 404;\n                            }\n                            return this.respond(response, request);\n                        }\n                    }\n                }\n                return this.respond(response, request);\n            });\n    }\n}\n","import { Collection } from './Collection';\nimport { Single } from './Single';\nimport { parseQueryString } from './parseQueryString';\n\nexport class Server {\n    constructor(baseUrl='') {\n        this.baseUrl = baseUrl;\n        this.loggingEnabled = false;\n        this.defaultQuery = () => {};\n        this.batchUrl = null;\n        this.collections = {};\n        this.singles = {};\n        this.requestInterceptors = [];\n        this.responseInterceptors = [];\n    }\n\n    /**\n     * Shortcut for adding several collections if identifierName is always 'id'\n     */\n    init(data) {\n        for (let name in data) {\n            if (Array.isArray(data[name])) {\n                this.addCollection(name, new Collection(data[name], 'id'));\n            } else {\n                this.addSingle(name, new Single(data[name]));\n            }\n        }\n    }\n\n    toggleLogging() {\n        this.loggingEnabled = !this.loggingEnabled;\n    }\n\n    /**\n     * @param Function ResourceName => object\n     */\n    setDefaultQuery(query) {\n        this.defaultQuery = query;\n    }\n\n    setBatchUrl(batchUrl) {\n        this.batchUrl = batchUrl;\n    }\n\n    /**\n     * @deprecated use setBatchUrl instead\n     */\n    setBatch(url) {\n        console.warn('Server.setBatch() is deprecated, use Server.setBatchUrl() instead');\n        this.batchUrl = url;\n    }\n\n    addCollection(name, collection) {\n        this.collections[name] = collection;\n        collection.setServer(this);\n        collection.setName(name);\n    }\n\n    getCollection(name) {\n        return this.collections[name];\n    }\n\n    getCollectionNames() {\n        return Object.keys(this.collections);\n    }\n\n    addSingle(name, single) {\n        this.singles[name] = single;\n        single.setServer(this);\n        single.setName(name);\n    }\n\n    getSingle(name) {\n        return this.singles[name];\n    }\n\n    getSingleNames() {\n        return Object.keys(this.singles);\n    }\n\n    addRequestInterceptor(interceptor) {\n        this.requestInterceptors.push(interceptor);\n    }\n\n    addResponseInterceptor(interceptor) {\n        this.responseInterceptors.push(interceptor);\n    }\n\n    /**\n     * @param {string} name\n     * @param {string} params As decoded from the query string, e.g. { sort: \"name\", filter: {enabled:true}, slice: [10, 20] }\n     */\n    getCount(name, params) {\n        return this.collections[name].getCount(params);\n    }\n\n    /**\n     * @param {string} name\n     * @param {string} params As decoded from the query string, e.g. { sort: \"name\", filter: {enabled:true}, slice: [10, 20] }\n     */\n    getAll(name, params) {\n        return this.collections[name].getAll(params);\n    }\n\n    getOne(name, identifier, params) {\n        return this.collections[name].getOne(identifier, params);\n    }\n\n    addOne(name, item) {\n        if (!this.collections.hasOwnProperty(name)) {\n            this.addCollection(name, new Collection([], 'id'));\n        }\n        return this.collections[name].addOne(item);\n    }\n\n    updateOne(name, identifier, item) {\n        return this.collections[name].updateOne(identifier, item);\n    }\n\n    removeOne(name, identifier) {\n        return this.collections[name].removeOne(identifier);\n    }\n\n    getOnly(name, params) {\n        return this.singles[name].getOnly();\n    }\n\n    updateOnly(name, item) {\n        return this.singles[name].updateOnly(item);\n    }\n\n\n    decode(request) {\n        request.queryString = decodeURIComponent(request.url.slice(request.url.indexOf('?') + 1));\n        request.params = parseQueryString(request.queryString);\n        if (request.requestBody) {\n            try {\n                request.json = JSON.parse(request.requestBody);\n            } catch(error) {\n                // body isn't JSON, skipping\n            }\n        }\n        return this.requestInterceptors.reduce(function(previous, current) {\n            return current(previous);\n        }, request);\n    }\n\n    respond(body, headers, request, status=200) {\n        if (!headers) {\n            headers = {};\n        }\n        if (!headers['Content-Type']) {\n            headers['Content-Type'] = 'application/json';\n        }\n        let response = { status: status, headers: headers, body: body };\n        response = this.responseInterceptors.reduce(function(previous, current) {\n            return current(previous, request);\n        }, response);\n        this.log(request, response);\n\n        return request.respond(response.status, response.headers, JSON.stringify(response.body));\n    }\n\n    log(request, response) {\n        if (!this.loggingEnabled) return;\n        if (console.group) {\n            // Better logging in Chrome\n            console.groupCollapsed(request.method, request.url, '(FakeRest)');\n            console.group('request');\n            console.log(request.method, request.url);\n            console.log('headers', request.requestHeaders);\n            console.log('body   ', request.requestBody);\n            console.groupEnd();\n            console.group('response', response.status);\n            console.log('headers', response.headers);\n            console.log('body   ', response.body);\n            console.groupEnd();\n            console.groupEnd();\n        } else {\n            console.log('FakeRest request ', request.method, request.url, 'headers', request.requestHeaders, 'body', request.requestBody);\n            console.log('FakeRest response', response.status, 'headers', response.headers, 'body', response.body);\n        }\n    }\n\n    batch(request) {\n\n        var json = request.json;\n        var handle = this.handle.bind(this);\n\n        var jsonResponse = Object.keys(json).reduce(function (jsonResponse, requestName) {\n            var subResponse;\n            var sub = {\n                url: json[requestName],\n                method: 'GET',\n                params: {},\n                respond: function (code, headers, body) {\n                    subResponse = {\n                        code: code,\n                        headers: Object.keys(headers || {}).map(function (headerName) {\n                            return {\n                                'name': headerName,\n                                'value': headers[headerName]\n                            };\n                        }),\n                        body: body || {}\n                    };\n                }\n            };\n            handle(sub);\n\n            jsonResponse[requestName] = subResponse || {\n                code: 404,\n                headers: [],\n                body: {}\n            };\n\n            return jsonResponse;\n        }, {});\n\n        return this.respond(jsonResponse, {}, request, 200);\n    }\n\n    /**\n     * @param {FakeXMLHttpRequest} request\n     *\n     * String request.url The URL set on the request object.\n     * String request.method The request method as a string.\n     * Object request.requestHeaders An object of all request headers, i.e.:\n     *     {\n     *         \"Accept\": \"text/html\",\n     *         \"Connection\": \"keep-alive\"\n     *     }\n     * String request.requestBody The request body\n     * String request.username Username, if any.\n     * String request.password Password, if any.\n     */\n    handle(request) {\n        request = this.decode(request);\n\n        if (this.batchUrl && this.batchUrl === request.url && request.method === 'POST') {\n            return this.batch(request);\n        }\n\n        // Handle Single Objects\n        for (let name of this.getSingleNames()) {\n            let matches = request.url.match(new RegExp('^' + this.baseUrl + '\\\\/(' + name + ')(\\\\/?.*)?$' ));\n            if (!matches) continue;\n\n            if (request.method == 'GET') {\n                try {\n                    let item = this.getOnly(name);\n                    return this.respond(item, null, request);\n                } catch (error) {\n                    return request.respond(404);\n                }\n            }\n            if (request.method == 'PUT') {\n                try {\n                    let item = this.updateOnly(name, request.json);\n                    return this.respond(item, null, request);\n                } catch (error) {\n                    return request.respond(404);\n                }\n            }\n            if (request.method == 'PATCH') {\n               try {\n                    let item = this.updateOnly(name, request.json);\n                    return this.respond(item, null, request);\n                } catch (error) {\n                    return request.respond(404);\n                }\n            }\n        }\n\n        // Handle collections\n        let matches = request.url.match(new RegExp('^' + this.baseUrl + '\\\\/([^\\\\/?]+)(\\\\/(\\\\d+))?(\\\\?.*)?$' ));\n        if (!matches) return;\n        let name = matches[1];\n        let params = Object.assign({}, this.defaultQuery(name), request.params);\n        if (!matches[2]) {\n            if (request.method == 'GET') {\n                if (!this.getCollection(name)) {\n                    return;\n                }\n                let count = this.getCount(name, params.filter ? { filter: params.filter } : {});\n                let items, contentRange, status;\n                if (count > 0) {\n                    items = this.getAll(name, params);\n                    let first = params.range ? params.range[0] : 0;\n                    let last = params.range ? Math.min(items.length - 1 + first, params.range[1]) : (items.length - 1);\n                    contentRange = `items ${first}-${last}/${count}`;\n                    status = (items.length == count) ? 200 : 206;\n                } else {\n                    items = [];\n                    contentRange = 'items */0';\n                    status = 200;\n                }\n                return this.respond(items, { 'Content-Range': contentRange }, request, status);\n            }\n            if (request.method == 'POST') {\n                let newResource = this.addOne(name, request.json);\n                let newResourceURI = this.baseUrl + '/' + name + '/' + newResource[this.getCollection(name).identifierName];\n                return this.respond(newResource, { Location: newResourceURI }, request, 201);\n            }\n        } else {\n            if (!this.getCollection(name)) {\n                return;\n            }\n            let id = matches[3];\n            if (request.method == 'GET') {\n                try {\n                    let item = this.getOne(name, id, params);\n                    return this.respond(item, null, request);\n                } catch (error) {\n                    return request.respond(404);\n                }\n            }\n            if (request.method == 'PUT') {\n                try {\n                    let item = this.updateOne(name, id, request.json);\n                    return this.respond(item, null, request);\n                } catch (error) {\n                    return request.respond(404);\n                }\n            }\n            if (request.method == 'PATCH') {\n                try {\n                    let item = this.updateOne(name, id, request.json);\n                    return this.respond(item, null, request);\n                } catch (error) {\n                    return request.respond(404);\n                }\n            }\n            if (request.method == 'DELETE') {\n                try {\n                    let item = this.removeOne(name, id);\n                    return this.respond(item, null, request);\n                } catch (error) {\n                    return request.respond(404);\n                }\n            }\n        }\n    }\n\n    getHandler() {\n        return this.handle.bind(this);\n    }\n}\n","export class Single {\n    constructor(obj) {\n        if (!(obj instanceof Object)) {\n            throw new Error('Can\\'t initialize a Single with anything except an object');\n        }\n        this.obj = obj;\n        this.server = null;\n        this.name = null;\n    }\n\n    /**\n     * A Single may need to access other collections (e.g. for embedded\n     * references) This is done through a reference to the parent server.\n     */\n    setServer(server) {\n        this.server = server;\n    }\n\n    setName(name) {\n        this.name = name;\n    }\n\n    // No need to embed Singles, since they are by their nature top-level\n    // No need to worry about remote references, (i.e. mysingleton_id=1) since\n    // it is by definition a singleton\n    _oneToManyEmbedder(resourceName) {\n        return (item) => {\n            const otherCollection = this.server.collections[resourceName];\n            if (!otherCollection) throw new Error(`Can't embed a non-existing collection ${resourceName}`);\n            // We have an array of ids {posts: [1,2]} (back refs are not valid\n            // for singleton)\n            item[resourceName] = otherCollection.getAll({\n                filter: i => item[resourceName].indexOf(i[otherCollection.identifierName]) !== -1\n            });\n            return item;\n        };      \n    }\n\n    _manyToOneEmbedder(resourceName) {\n        const pluralResourceName = resourceName + 's';\n        const referenceName = resourceName + '_id';\n        return (item) => {\n            const otherCollection = this.server.collections[pluralResourceName];\n            if (!otherCollection) throw new Error(`Can't embed a non-existing collection ${resourceName}`);\n            try {\n                item[resourceName] = otherCollection.getOne(item[referenceName]);\n            } catch (e) {\n                // Resource doesn't exist, so don't embed\n            }\n            return item;\n        };\n    }\n\n    _itemEmbedder(embed) {\n        const resourceNames = Array.isArray(embed) ? embed : [embed];\n        const resourceEmbedders = resourceNames.map(resourceName =>\n           resourceName.endsWith('s') ? this._oneToManyEmbedder(resourceName) : this._manyToOneEmbedder(resourceName)\n        );\n        return item => resourceEmbedders.reduce((itemWithEmbeds, embedder) => embedder(itemWithEmbeds), item);\n    }\n\n    getOnly(query) {\n        let item = this.obj;\n        if (query && query.embed && this.server) {\n            item = Object.assign({}, item); // Clone\n            item = this._itemEmbedder(query.embed)(item);\n        }\n        return item;\n    }\n\n    updateOnly(item) {\n        for (let key in item) {\n            this.obj[key] = item[key];\n        }\n        return this.obj;\n    }\n}\n","export function parseQueryString(queryString) {\n    if (!queryString) {\n        return {};\n    }\n    let queryObject = {};\n    let queryElements = queryString.split('&');\n\n    queryElements.map(function(queryElement) {\n        if (queryElement.indexOf('=') === -1) {\n            queryObject[queryElement] = true;\n        } else {\n            let [key, value] = queryElement.split('=');\n            if (value.indexOf('[') === 0 || value.indexOf('{') === 0) {\n                value = JSON.parse(value);\n            }\n            queryObject[key.trim()] = value;\n        }\n    });\n\n    return queryObject;\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(\"./src/FakeRest.js\");\n"],"sourceRoot":""}